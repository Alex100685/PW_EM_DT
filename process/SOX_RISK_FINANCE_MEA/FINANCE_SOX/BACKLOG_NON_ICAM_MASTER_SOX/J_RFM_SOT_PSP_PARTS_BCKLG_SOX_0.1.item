<?xml version="1.0" encoding="UTF-8" standalone="no"?><talendfile:ProcessType xmlns:talendfile="platform:/resource/org.talend.model/model/TalendFile.xsd" xmlns:xmi="http://www.omg.org/XMI" defaultContext="Dev" framework="" jobType="Standard" xmi:version="2.0">
  <context confirmationNeeded="false" name="Prod">
    <contextParameter comment="" name="RFM_GPDB_SOT_BACKLOG_AWS_Database" prompt="RFM_GPDB_SOT_BACKLOG_AWS_Database?" promptNeeded="false" repositoryContextId="_woKUACKgEem6xLcLHx8Cdw" type="id_String" value="pgsdwh"/>
    <contextParameter comment="" name="RFM_GPDB_SOT_BACKLOG_AWS_Login" prompt="RFM_GPDB_SOT_BACKLOG_AWS_Login?" promptNeeded="false" repositoryContextId="_woKUACKgEem6xLcLHx8Cdw" type="id_String" value="502799797"/>
    <contextParameter comment="" name="RFM_GPDB_SOT_BACKLOG_AWS_Password" prompt="RFM_GPDB_SOT_BACKLOG_AWS_Password?" promptNeeded="false" repositoryContextId="_woKUACKgEem6xLcLHx8Cdw" type="id_Password" value="rrc5fueW52wV6gxceuPvkA=="/>
    <contextParameter comment="" name="RFM_GPDB_SOT_BACKLOG_AWS_Port" prompt="RFM_GPDB_SOT_BACKLOG_AWS_Port?" promptNeeded="false" repositoryContextId="_woKUACKgEem6xLcLHx8Cdw" type="id_String" value="5432"/>
    <contextParameter comment="" name="RFM_GPDB_SOT_BACKLOG_AWS_Schema" prompt="RFM_GPDB_SOT_BACKLOG_AWS_Schema?" promptNeeded="false" repositoryContextId="_woKUACKgEem6xLcLHx8Cdw" type="id_String" value="sot_pgsbacklog"/>
    <contextParameter comment="" name="RFM_GPDB_SOT_BACKLOG_AWS_Server" prompt="RFM_GPDB_SOT_BACKLOG_AWS_Server?" promptNeeded="false" repositoryContextId="_woKUACKgEem6xLcLHx8Cdw" type="id_String" value="9ha.cloud.digital.ge.com"/>
  </context>
  <context confirmationNeeded="false" name="Dev">
    <contextParameter comment="" name="RFM_GPDB_SOT_BACKLOG_AWS_Database" prompt="RFM_GPDB_SOT_BACKLOG_AWS_Database?" promptNeeded="false" repositoryContextId="_woKUACKgEem6xLcLHx8Cdw" type="id_String" value="pgsdwh"/>
    <contextParameter comment="" name="RFM_GPDB_SOT_BACKLOG_AWS_Login" prompt="RFM_GPDB_SOT_BACKLOG_AWS_Login?" promptNeeded="false" repositoryContextId="_woKUACKgEem6xLcLHx8Cdw" type="id_String" value="502799797"/>
    <contextParameter comment="" name="RFM_GPDB_SOT_BACKLOG_AWS_Password" prompt="RFM_GPDB_SOT_BACKLOG_AWS_Password?" promptNeeded="false" repositoryContextId="_woKUACKgEem6xLcLHx8Cdw" type="id_Password" value="fi0GrmC/1V0ODoUV9RtJTQ=="/>
    <contextParameter comment="" name="RFM_GPDB_SOT_BACKLOG_AWS_Port" prompt="RFM_GPDB_SOT_BACKLOG_AWS_Port?" promptNeeded="false" repositoryContextId="_woKUACKgEem6xLcLHx8Cdw" type="id_String" value="5432"/>
    <contextParameter comment="" name="RFM_GPDB_SOT_BACKLOG_AWS_Schema" prompt="RFM_GPDB_SOT_BACKLOG_AWS_Schema?" promptNeeded="false" repositoryContextId="_woKUACKgEem6xLcLHx8Cdw" type="id_String" value="sot_pgsbacklog"/>
    <contextParameter comment="" name="RFM_GPDB_SOT_BACKLOG_AWS_Server" prompt="RFM_GPDB_SOT_BACKLOG_AWS_Server?" promptNeeded="false" repositoryContextId="_woKUACKgEem6xLcLHx8Cdw" type="id_String" value="dev-9ha.cloud.digital.ge.com"/>
  </context>
  <parameters>
    <elementParameter field="TEXT" name="SCREEN_OFFSET_X" show="false" value="0"/>
    <elementParameter field="TEXT" name="SCREEN_OFFSET_Y" show="false" value="0"/>
    <elementParameter field="TEXT" name="REPOSITORY_CONNECTION_ID" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_PROPERTY_TYPENAME" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_HADOOP_DISTRIBUTION" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_HADOOP_VERSION" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_ENABLE_KERBEROS" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_NAME_NODE_PRINCIPAL" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_USERNAME" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_GROUP" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_USE_KEYTAB" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_KT_PRINCIPAL" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_KEY_TAB" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_ENABLE_OO_KERBEROS" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_NAME_NODE_END_POINT" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_JOB_TRACKER_ENDPOINT" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_END_POINT" show="false" value=""/>
    <elementParameter field="CHECK" name="IMPLICITCONTEXT_USE_PROJECT_SETTINGS" show="false" value="true"/>
    <elementParameter field="CHECK" name="STATANDLOG_USE_PROJECT_SETTINGS" show="false" value="true"/>
    <elementParameter field="CHECK" name="MULTI_THREAD_EXECATION" value="false"/>
    <elementParameter field="TEXT" name="PARALLELIZE_UNIT_SIZE" value="25000"/>
    <elementParameter field="CHECK" name="IMPLICIT_TCONTEXTLOAD" value="false"/>
    <elementParameter field="RADIO" name="FROM_FILE_FLAG_IMPLICIT_CONTEXT" show="false" value="false"/>
    <elementParameter field="RADIO" name="FROM_DATABASE_FLAG_IMPLICIT_CONTEXT" show="false" value="false"/>
    <elementParameter field="FILE" name="IMPLICIT_TCONTEXTLOAD_FILE" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="FIELDSEPARATOR" show="false" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="PROPERTY_TYPE_IMPLICIT_CONTEXT:PROPERTY_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="PROPERTY_TYPE_IMPLICIT_CONTEXT:REPOSITORY_PROPERTY_TYPE" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_TYPE_IMPLICIT_CONTEXT" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION_IMPLICIT_CONTEXT" show="false" value=""/>
    <elementParameter field="TEXT" name="URL_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TABLE" name="DRIVER_JAR_IMPLICIT_CONTEXT" show="false"/>
    <elementParameter field="TEXT" name="DRIVER_CLASS_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="HOST_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PORT_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="DBNAME_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="LOCAL_SERVICE_NAME_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="SCHEMA_DB_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="USER_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="PASSWORD" name="PASS_IMPLICIT_CONTEXT" show="false" value="0RMsyjmybrE="/>
    <elementParameter field="FILE" name="DBFILE_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="DBTABLE" name="DBTABLE_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="QUERY_CONDITION_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="CLOSED_LIST" name="LOAD_NEW_VARIABLE" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="NOT_LOAD_OLD_VARIABLE" show="false" value=""/>
    <elementParameter field="CHECK" name="PRINT_OPERATIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="DISABLE_ERROR" show="false" value="false"/>
    <elementParameter field="CHECK" name="DISABLE_WARNINGS" show="false" value="false"/>
    <elementParameter field="CHECK" name="DISABLE_INFO" show="false" value="false"/>
    <elementParameter field="CHECK" name="ON_STATCATCHER_FLAG" value="true"/>
    <elementParameter field="CHECK" name="ON_LOGCATCHER_FLAG" value="true"/>
    <elementParameter field="CHECK" name="ON_METERCATCHER_FLAG" value="true"/>
    <elementParameter field="CHECK" name="ON_CONSOLE_FLAG" value="true"/>
    <elementParameter field="CHECK" name="ON_FILES_FLAG" value="false"/>
    <elementParameter field="DIRECTORY" name="FILE_PATH" show="false" value="&quot;C:/talend/qa/.metadata&quot;"/>
    <elementParameter field="TEXT" name="FILENAME_STATS" show="false" value="&quot;stats_file.txt&quot;"/>
    <elementParameter field="TEXT" name="FILENAME_LOGS" show="false" value="&quot;logs_file.txt&quot;"/>
    <elementParameter field="TEXT" name="FILENAME_METTER" show="false" value="&quot;meter_file.txt&quot;"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="ISO-8859-15"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" show="false" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="ON_DATABASE_FLAG" value="true"/>
    <elementParameter field="CLOSED_LIST" name="DB_TYPE" value="tMysqlOutput"/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="MYSQL_5"/>
    <elementParameter field="TEXT" name="URL" show="false" value="&quot;&quot;"/>
    <elementParameter field="TABLE" name="DRIVER_JAR" show="false"/>
    <elementParameter field="TEXT" name="DRIVER_CLASS" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="HOST" value="&quot;3.48.32.71&quot;"/>
    <elementParameter field="TEXT" name="PORT" value="&quot;3306&quot;"/>
    <elementParameter field="TEXT" name="DATASOURCE" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="DBNAME" value="&quot;testlogdb&quot;"/>
    <elementParameter field="TEXT" name="LOCAL_SERVICE_NAME" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" show="false" value=""/>
    <elementParameter field="TEXT" name="USER" value="&quot;talend631&quot;"/>
    <elementParameter field="PASSWORD" name="PASS" value="nSmcr40OOghDG8zEa9PpZw=="/>
    <elementParameter field="FILE" name="DBFILE" show="false" value="&quot;&quot;"/>
    <elementParameter field="DBTABLE" name="TABLE_STATS" value="&quot;talend_stats&quot;"/>
    <elementParameter field="DBTABLE" name="TABLE_LOGS" value="&quot;talend_logs&quot;"/>
    <elementParameter field="DBTABLE" name="TABLE_METER" value="&quot;talend_flowmeter&quot;"/>
    <elementParameter field="CHECK" name="CATCH_RUNTIME_ERRORS" value="true"/>
    <elementParameter field="CHECK" name="CATCH_USER_ERRORS" value="true"/>
    <elementParameter field="CHECK" name="CATCH_USER_WARNING" value="true"/>
    <elementParameter field="CHECK" name="CATCH_REALTIME_STATS" value="true"/>
    <elementParameter field="TEXT" name="HEADERFOOTER_HEADERID" show="false" value=""/>
    <elementParameter field="CHECK" name="HEADER_ENABLED" show="false" value="false"/>
    <elementParameter field="TEXT" name="HEADER_LIBRARY" show="false" value=""/>
    <elementParameter field="TEXT" name="HEADER_CODE" show="false" value=""/>
    <elementParameter field="TEXT" name="HEADER_IMPORT" show="false" value=""/>
    <elementParameter field="TEXT" name="HEADERFOOTER_FOOTERID" show="false" value=""/>
    <elementParameter field="CHECK" name="FOOTER_ENABLED" show="false" value="false"/>
    <elementParameter field="TEXT" name="FOOTER_LIBRARY" show="false" value=""/>
    <elementParameter field="TEXT" name="FOOTER_CODE" show="false" value=""/>
    <elementParameter field="TEXT" name="FOOTER_IMPORT" show="false" value=""/>
    <routinesParameter id="_QNVYYMpoEeO1jq8eAwNUvQ" name="DQTechnical"/>
    <routinesParameter id="_Z4RCQMWqEeOb2v5_LgjFkA" name="DataOperation"/>
    <routinesParameter id="_6kJxAITHEeacVarjMrbhgQ" name="DataQualityDependencies"/>
    <routinesParameter id="_QNskwMpoEeO1jq8eAwNUvQ" name="DataQuality"/>
    <routinesParameter id="_QNGH0MpoEeO1jq8eAwNUvQ" name="DqStringHandling"/>
    <routinesParameter id="_QM2QMMpoEeO1jq8eAwNUvQ" name="MDM"/>
    <routinesParameter id="_Z54L0MWqEeOb2v5_LgjFkA" name="Mathematical"/>
    <routinesParameter id="_Z7cSEMWqEeOb2v5_LgjFkA" name="Numeric"/>
    <routinesParameter id="_Z82AQMWqEeOb2v5_LgjFkA" name="Relational"/>
    <routinesParameter id="_XojCYMWqEeOb2v5_LgjFkA" name="SQLike"/>
    <routinesParameter id="_Z-SKsMWqEeOb2v5_LgjFkA" name="StringHandling"/>
    <routinesParameter id="_Z_r44MWqEeOb2v5_LgjFkA" name="TalendDataGenerator"/>
    <routinesParameter id="_aBUQkMWqEeOb2v5_LgjFkA" name="TalendDate"/>
    <routinesParameter id="_aC0FYMWqEeOb2v5_LgjFkA" name="TalendString"/>
    <routinesParameter id="_1VSg4Mj3EeepVanzWe1wyQ" name="DataMasking"/>
  </parameters>
  <node componentName="tGreenplumRow" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="384" posY="64">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tGreenplumRow_1"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="true"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" value="tGreenplumConnection_1"/>
    <elementParameter field="TEXT" name="HOST" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PORT" show="false" value="&quot;5432&quot;"/>
    <elementParameter field="TEXT" name="DBNAME" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="PostgreSQL"/>
    <elementParameter field="TEXT" name="USER" show="false" value="&quot;&quot;"/>
    <elementParameter field="PASSWORD" name="PASS" show="false" value="0RMsyjmybrE="/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="USE_SSL" show="false" value="true"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;INSERT INTO SOT_PGSBACKLOG.PARTS_LINE_HEADERS_PSP&#13;&#10;SELECT DISTINCT a.LINE_NUMBER,&#13;&#10;  a.UNIT_LIST_PRICE,&#13;&#10;  a.ORDERED_QUANTITY,&#13;&#10;  a.REQUEST_DATE,&#13;&#10;  a.SHIPPED_QUANTITY,&#13;&#10;  a.UNIT_SELLING_PRICE,&#13;&#10;  a.line_category_code,&#13;&#10;  a.SCHEDULE_SHIP_DATE,&#13;&#10;  a.promise_date,&#13;&#10;  a.ACTUAL_SHIPMENT_DATE,&#13;&#10;  a.LINE_ID,&#13;&#10;  a.SHIPMENT_PRIORITY_CODE,&#13;&#10;  a.FLOW_STATUS_CODE,&#13;&#10;  a.INVENTORY_ITEM_ID,&#13;&#10;  a.SHIP_FROM_ORG_ID,&#13;&#10;  a.SOLD_TO_ORG_ID,&#13;&#10;  b.ORDER_NUMBER,&#13;&#10;  b.CUST_PO_NUMBER,&#13;&#10;  b.FOB_POINT_CODE,&#13;&#10;  b.TRANSACTIONAL_CURR_CODE,&#13;&#10;  b.ATTRIBUTE12,&#13;&#10;  b.BOOKED_DATE,&#13;&#10;  b.attribute5,&#13;&#10;  b.payment_term_id,&#13;&#10;  b.attribute6,&#13;&#10;  b.attribute7,&#13;&#10;  b.SHIP_TO_ORG_ID,&#13;&#10;  b.INVOICE_TO_ORG_ID,&#13;&#10;  TO_DATE(B.creation_date,'yyyy-mm-dd') creation_date,&#13;&#10;  oos.name order_src_name,&#13;&#10;  c.NAME trans_name,&#13;&#10;  ca.NAME trns_types_name,&#13;&#10;  a.line_type_id,&#13;&#10;  FLEX.CUSTOMER_TYPE&#13;&#10;FROM&#13;&#10;  (SELECT DISTINCT a.LINE_NUMBER,&#13;&#10;    a.UNIT_LIST_PRICE,&#13;&#10;    a.ORDERED_QUANTITY,&#13;&#10;    a.REQUEST_DATE,&#13;&#10;    a.SHIPPED_QUANTITY,&#13;&#10;    a.UNIT_SELLING_PRICE,&#13;&#10;    a.line_category_code,&#13;&#10;    a.SCHEDULE_SHIP_DATE,&#13;&#10;    a.promise_date,&#13;&#10;    a.ACTUAL_SHIPMENT_DATE,&#13;&#10;    a.LINE_ID,&#13;&#10;    a.SHIPMENT_PRIORITY_CODE,&#13;&#10;    a.FLOW_STATUS_CODE,&#13;&#10;    a.header_id,&#13;&#10;    a.line_type_id,&#13;&#10;    a.INVENTORY_ITEM_ID,&#13;&#10;    a.SHIP_FROM_ORG_ID,&#13;&#10;    a.SOLD_TO_ORG_ID&#13;&#10;  FROM pgsalpha.oe_order_lines_all a&#13;&#10;  WHERE a.FLOW_STATUS_CODE NOT IN ('AWAITING_RECEIPT', 'AWAITING_RETURN', 'AWAITING_RETURN_DISPOSITION', 'CANCELLED', 'CLOSED', 'ENTERED')&#13;&#10;  ) a&#13;&#10;LEFT OUTER JOIN pgsalpha.oe_order_headers_all b&#13;&#10;ON (a.header_id=b.header_id)&#13;&#10;LEFT OUTER JOIN pgsalpha.oe_order_sources oos&#13;&#10;ON (b.order_source_id=oos.order_source_id)&#13;&#10;LEFT OUTER JOIN pgsalpha.oe_transaction_types_tl c&#13;&#10;ON (a.line_type_id=c.TRANSACTION_TYPE_ID)&#13;&#10;LEFT OUTER JOIN pgsalpha.OE_TRANSACTION_TYPES_TL ca&#13;&#10;ON (b.order_type_id=ca.transaction_type_id)&#13;&#10;LEFT OUTER JOIN&#13;&#10;  (SELECT DISTINCT FLEX_VALUES.DESCRIPTION AS CUSTOMER_TYPE,&#13;&#10;    CUST_SITE.SITE_USE_ID                  AS SITE_USE_ID&#13;&#10;  FROM pgsalpha.HZ_CUST_SITE_USES_ALL CUST_SITE&#13;&#10;  INNER JOIN pgsalpha.GL_CODE_COMBINATIONS CODE_COMBINATION&#13;&#10;  ON (CODE_COMBINATION.CODE_COMBINATION_ID =CUST_SITE.gl_id_rev)&#13;&#10;  INNER JOIN pgsalpha.fnd_flex_values_tl FLEX_VALUES&#13;&#10;  ON (FLEX_VALUES.FLEX_VALUE_MEANING         =CODE_COMBINATION.SEGMENT2)&#13;&#10;  )flex ON (b.INVOICE_TO_ORG_ID              = flex.SITE_USE_ID)&#13;&#10;WHERE ca.LANGUAGE                            ='US'&#13;&#10;AND (INSTR(UPPER(CA.NAME),'PERFORMANCE',0,1) &gt;0)&#13;&#10;AND (upper(ca.name) LIKE '%PERFORMANCE%')&#13;&#10;AND UPPER((LTRIM(b.CUST_PO_NUMBER))) NOT LIKE 'ADV%'&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="true"/>
    <elementParameter field="CHECK" name="PROPAGATE_RECORD_SET" value="false"/>
    <elementParameter field="COLUMN_LIST" name="RECORD_SET_COLUMN" show="false" value=""/>
    <elementParameter field="CHECK" name="USE_PREPAREDSTATEMENT" value="false"/>
    <elementParameter field="TABLE" name="SET_PREPAREDSTATEMENT_PARAMETERS" show="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" show="false" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="PSP LINE HEADERS"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tGreenplumRow_1"/>
    <metadata connector="REJECT" name="REJECT">
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tGreenplumRow" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="544" posY="64">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tGreenplumRow_2"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="true"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" value="tGreenplumConnection_1"/>
    <elementParameter field="TEXT" name="HOST" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PORT" show="false" value="&quot;5432&quot;"/>
    <elementParameter field="TEXT" name="DBNAME" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="PostgreSQL"/>
    <elementParameter field="TEXT" name="USER" show="false" value="&quot;&quot;"/>
    <elementParameter field="PASSWORD" name="PASS" show="false" value="0RMsyjmybrE="/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="USE_SSL" show="false" value="true"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;INSERT INTO SOT_PGSBACKLOG.PARTS_BACKLOG_STG_PSP&#13;&#10;SELECT DISTINCT ROW_NUMBER() OVER (PARTITION BY '1' ORDER BY '1'),&#13;&#10;  'Parts PSP' SOURCE_DATA,&#13;&#10;  TRIM(TO_CHAR(plh.ORDER_NUMBER,'9999999999999')) AS ORDER_NUMBER,&#13;&#10;  TRIM(TO_CHAR(plh.LINE_NUMBER,'999999999999'))   AS LINE_NUM,&#13;&#10;  j1.FULL_NAME                                  AS OA,&#13;&#10;  RT.SEGMENT2 SALES_REGION,&#13;&#10;  plh.order_src_name ORDER_SOURCE,&#13;&#10;  loc.COUNTRY COUNTRY_CODE,&#13;&#10;  DECODE(PLH.trns_types_name,NULL,'Not Available', PLH.trns_types_name) ORDER_TYPE,&#13;&#10;  plh.CUST_PO_NUMBER,&#13;&#10;  NULL ORDERED_PART_NUM,&#13;&#10;  e.DESCRIPTION,&#13;&#10;  MCAT1.FAMILY_CODE FAMILY_CODE,&#13;&#10;  plh.UNIT_LIST_PRICE UNIT_LIST_PRICE,&#13;&#10;  plh.ORDERED_QUANTITY QUANTITY,&#13;&#10;  rtt.name PAYMENT_TERMS,&#13;&#10;  plh.FOB_POINT_CODE TITLE_XFER_POINT,&#13;&#10;  NULL,&#13;&#10;  --FLV1.SHIP_METHOD SHIP_METHOD,&#13;&#10;  CAST(NULL AS DATE) ENTER_DATE,&#13;&#10;  plh.REQUEST_DATE REQUEST_DATE,&#13;&#10;  plh.SHIPPED_QUANTITY SHIPPED_QTY,&#13;&#10;  ccp.INSTANCE_TYPE_CODE AS TURBINE_TECHNOLOGY,&#13;&#10;  CASE&#13;&#10;    WHEN (line_cat.line_category = 'BILL ONLY'&#13;&#10;    OR line_cat.line_category    = 'BILL _ SHIP'&#13;&#10;    OR line_cat.line_category    ='OTHER SHIP ONLY')&#13;&#10;    THEN (plh.ORDERED_QUANTITY*plh.UNIT_SELLING_PRICE*DECODE(plh.transactional_curr_code,'USD',1,  conv_rt.conversion_rate))&#13;&#10;    ELSE 0&#13;&#10;  END extended_price,&#13;&#10;  DECODE(plh.line_category_code,'RETURN',-1,1) * plh.ordered_quantity * cic.item_cost AS EXTENDED_COST, &#13;&#10;  CAST(NULL AS INTEGER) INVOICED_QTY,&#13;&#10;  NULL INVOICE_NUM,&#13;&#10;  CAST(NULL AS DATE) INVOICE_DATE,&#13;&#10;  CAST(NULL AS DATE) GL_POSTED_DATE,&#13;&#10;  gfs.frame_size FRAME_SIZE,&#13;&#10;  ccp.ATTRIBUTE3 AS FRAME_TYPE,&#13;&#10;  plh.SCHEDULE_SHIP_DATE SCHED_SHIP_DATE,&#13;&#10;  CASE&#13;&#10;    WHEN PLH.trans_name='Closed Lines'&#13;&#10;    THEN plh.promise_date&#13;&#10;    ELSE plh.ACTUAL_SHIPMENT_DATE&#13;&#10;  END SHIP_DATE,&#13;&#10;  PLH.transactional_curr_code CURRENCY,&#13;&#10;  LTRIM(RTRIM(PLH.trans_name)) AS LINE_TYPE,&#13;&#10;  plh.LINE_ID LINE_ID,&#13;&#10;  plh.SHIPMENT_PRIORITY_CODE PRIORITY,&#13;&#10;  plh.FLOW_STATUS_CODE LINE_STATUS,&#13;&#10;  NULL REVENUE_ACCT_NUM,&#13;&#10;  NULL ACCOUNT_NO_COMPARE,&#13;&#10;  CASE&#13;&#10;    WHEN line_cat.line_category like 'BILL _ SHIP'&#13;&#10;    OR line_cat.line_category  ='OTHER SHIP ONLY'&#13;&#10;    THEN 'Y'&#13;&#10;    ELSE 'N'&#13;&#10;  END SHIPPABLE,&#13;&#10;  CASE&#13;&#10;    WHEN line_cat.line_category like 'BILL _ SHIP'&#13;&#10;    OR line_cat.line_category  ='BILL ONLY'&#13;&#10;    THEN 'Y'&#13;&#10;    ELSE 'N'&#13;&#10;  END BILLABLE,&#13;&#10;  NULL ADV,&#13;&#10;  NULL INVOICE_FLAG,&#13;&#10;  plh.PROMISE_DATE AS PROMISE_DATE,&#13;&#10;  e.INVOICEABLE_ITEM_FLAG INVOICEABLE_ITEM_FLAG,&#13;&#10;  NULL LINE_HOLD,&#13;&#10;  PLH.CUSTOMER_TYPE,&#13;&#10;  RT.SEGMENT1   AS POLE,&#13;&#10;  ja1.FULL_NAME AS PROJ_MANAGER,&#13;&#10;  NULL HDR_HOLD,&#13;&#10;  e.segment1              AS PART_NUMBER,&#13;&#10;  ship_to_bill.PARTY_NAME AS BILL_TO_CUST_NAME,&#13;&#10;  ship_to_bill.PARTY_NAME AS SHIP_TO_CUST_NAME,&#13;&#10;  ltrim(rtrim(SUBSTR(( DECODE(PLH.trns_types_name,NULL,'Not Available',PLH.trns_types_name) ),1,13))) PANDL,&#13;&#10;  CAST(NULL AS INTEGER) MTLS_BOOKED,&#13;&#10;  CAST(NULL AS INTEGER) SALES_BOOKED,&#13;&#10;  plh.ATTRIBUTE12 AS ADN_NUMBER,&#13;&#10;  plh.BOOKED_DATE AS BOOK_DATE,&#13;&#10;  NULL MODEL_LIST,&#13;&#10;  loc.STATE AS STATE,&#13;&#10;  CAST(NULL AS DATE) LAST_UPDATE_DATE,&#13;&#10;  CAST(NULL AS DATE) ORIG_REQUEST_DATE,&#13;&#10;  mcat.DIVISION_CODE ITEM_CATEGORY,&#13;&#10;  LTRIM(RTRIM(ccp.name)) AS TURBINE_NUM,&#13;&#10;  NULL SALES_CHANNEL,&#13;&#10;  CAST(NULL AS INTEGER) UNIT_SELLING_PRICE,&#13;&#10;  CAST(NULL AS INTEGER) LIST_PRICE_USD,&#13;&#10;  NULL TRADESPHER_FLAG,&#13;&#10;  CASE&#13;&#10;    WHEN PLH.trns_types_name LIKE 'NUS%'&#13;&#10;    THEN 'NUS'&#13;&#10;    WHEN PLH.trns_types_name LIKE 'Energy Parts%'&#13;&#10;    THEN 'Energy Parts'&#13;&#10;    WHEN PLH.trns_types_name LIKE 'Contractual Services%'&#13;&#10;    THEN 'Contractual Services'&#13;&#10;    WHEN PLH.trns_types_name LIKE 'Performance Services%'&#13;&#10;    THEN 'Performance Services'&#13;&#10;  END ME,&#13;&#10;  (plh.ORDERED_QUANTITY*plh.UNIT_SELLING_PRICE) AS ORDER_AMOUNT&#13;&#10;FROM SOT_PGSBACKLOG.PARTS_LINE_HEADERS_PSP PLH&#13;&#10;LEFT OUTER JOIN (SELECT DISTINCT e.DESCRIPTION,e.INVOICEABLE_ITEM_FLAG,&#13;&#10;  e.segment1,e.INVENTORY_ITEM_ID from pgsalpha.mtl_system_items_b e WHERE &#13;&#10;  e.organization_id                       =2006&#13;&#10;AND SUBSTR(e.SEGMENT1,1,4)                 != 'PROP'&#13;&#10;AND e.INVOICEABLE_ITEM_FLAG                 = 'Y')e&#13;&#10;ON (PLH.INVENTORY_ITEM_ID=e.INVENTORY_ITEM_ID)&#13;&#10;LEFT OUTER JOIN&#13;&#10;  (SELECT MAX(mc.SEGMENT1) AS DIVISION_CODE,&#13;&#10;    mic.INVENTORY_ITEM_ID  AS INVENTORY_ITEM_ID,&#13;&#10;    mic.ORGANIZATION_ID    AS ORGANIZATION_ID&#13;&#10;  FROM pgsalpha.mtl_categories_b mc&#13;&#10;  INNER JOIN pgsalpha.mtl_item_categories mic&#13;&#10;  ON (mc.CATEGORY_ID = mic.CATEGORY_ID)&#13;&#10;  INNER JOIN pgsalpha.MTL_CATEGORY_SETS_B mcs&#13;&#10;  ON (mcs.STRUCTURE_ID    = mc.STRUCTURE_ID)&#13;&#10;  WHERE  mcs.CATEGORY_SET_ID = 6&#13;&#10;  AND COALESCE(mc.SEGMENT1,'NA') NOT  IN ('ID','TC','IC')&#13;&#10;  GROUP BY INVENTORY_ITEM_ID,&#13;&#10;    ORGANIZATION_ID&#13;&#10;  ) mcat ON (PLH.INVENTORY_ITEM_ID=mcat.INVENTORY_ITEM_ID)&#13;&#10;AND (PLH.SHIP_FROM_ORG_ID         =mcat.ORGANIZATION_ID)&#13;&#10;LEFT OUTER JOIN&#13;&#10;  (SELECT MAX(mc.SEGMENT1) AS FAMILY_CODE,&#13;&#10;    mic.INVENTORY_ITEM_ID  AS INVENTORY_ITEM_ID,&#13;&#10;    mic.ORGANIZATION_ID    AS ORGANIZATION_ID&#13;&#10;  FROM pgsalpha.mtl_categories_b mc&#13;&#10;  INNER JOIN pgsalpha.mtl_item_categories mic&#13;&#10;  ON (mc.CATEGORY_ID = mic.CATEGORY_ID)&#13;&#10;  INNER JOIN pgsalpha.MTL_CATEGORY_SETS_B mcs&#13;&#10;  ON (mcs.STRUCTURE_ID    = mc.STRUCTURE_ID)&#13;&#10;  AND mcs.CATEGORY_SET_ID = 7&#13;&#10;  GROUP BY INVENTORY_ITEM_ID,&#13;&#10;    ORGANIZATION_ID&#13;&#10;  ) mcat1 ON (PLH.INVENTORY_ITEM_ID=mcat1.INVENTORY_ITEM_ID)&#13;&#10;AND (PLH.SHIP_FROM_ORG_ID          =mcat1.ORGANIZATION_ID)&#13;&#10;LEFT OUTER JOIN (select DISTINCT rtt.name,rtt.term_id from pgsalpha.ra_terms_tl rtt)rtt&#13;&#10;ON (PLH.payment_term_id=rtt.term_id)&#13;&#10;LEFT OUTER JOIN&#13;&#10;  (SELECT DISTINCT C.attribute3,&#13;&#10;    C.INSTANCE_TYPE_CODE INSTANCE_TYPE_CODE,&#13;&#10;    C.INSTANCE_ID,&#13;&#10;    ltrim(rtrim(A.name)) AS name&#13;&#10;  FROM pgsalpha.CSI_SYSTEMS_TL A&#13;&#10;  INNER JOIN pgsalpha.CSI_SYSTEMS_B B&#13;&#10;  ON (A.system_id=B.system_id)&#13;&#10;  INNER JOIN pgsalpha.CSI_ITEM_INSTANCES C&#13;&#10;  ON (B.system_id       =C.system_id)&#13;&#10;  ) ccp ON (PLH.attribute5=ccp.instance_id)&#13;&#10;LEFT OUTER JOIN pgsalpha.geps_frame_size gfs&#13;&#10;ON (ccp.attribute3=gfs.frame_type)&#13;&#10;LEFT OUTER JOIN&#13;&#10;  (SELECT DISTINCT FULL_NAME, person_id FROM pgsalpha.per_all_people_f&#13;&#10;  )j1&#13;&#10;ON (PLH.attribute6=j1.person_id)&#13;&#10;LEFT OUTER JOIN&#13;&#10;  (SELECT DISTINCT FULL_NAME, person_id FROM pgsalpha.per_all_people_f ja&#13;&#10;  )ja1&#13;&#10;ON (PLH.attribute7=ja1.person_id)&#13;&#10;LEFT OUTER JOIN&#13;&#10;  (SELECT HCA.account_number AS BILL_TO_CUST_NUM,&#13;&#10;    HCS.PARTY_SITE_ID        AS PARTY_SITE_ID,&#13;&#10;    HP.PARTY_ID              AS PARTY_ID,&#13;&#10;    HP.PARTY_NAME,&#13;&#10;    HCU.SITE_USE_ID AS SITE_USE_ID,&#13;&#10;    HCU.TERRITORY_ID&#13;&#10;  FROM pgsalpha.HZ_CUST_ACCOUNTS HCA,&#13;&#10;    pgsalpha.HZ_CUST_ACCT_SITES_ALL HCS,&#13;&#10;    pgsalpha.HZ_CUST_SITE_USES_ALL HCU,&#13;&#10;    pgsalpha.HZ_PARTIES HP&#13;&#10;  WHERE HCU.cust_acct_site_id = HCS.cust_acct_site_id&#13;&#10;  AND HCS.cust_account_id     = HCA.cust_account_id&#13;&#10;  AND HCA.PARTY_ID            = HP.PARTY_ID&#13;&#10;  ) ship_to_bill&#13;&#10;ON (PLH.SHIP_TO_ORG_ID=ship_to_bill.SITE_USE_ID)&#13;&#10;LEFT OUTER JOIN (select RT.segment1,RT.segment2,RT.TERRITORY_ID from PGSALPHA.RA_TERRITORIES RT)RT&#13;&#10;ON (ship_to_bill.TERRITORY_ID=RT.TERRITORY_ID)&#13;&#10;LEFT OUTER JOIN&#13;&#10;  (SELECT hzl.state,&#13;&#10;    hzl.country,&#13;&#10;    hzl.location_id AS LOCATION_ID,&#13;&#10;    hcu.SITE_USE_ID AS SITE_USE_ID&#13;&#10;  FROM pgsalpha.HZ_CUST_ACCT_SITES_ALL hcs,&#13;&#10;    pgsalpha.HZ_CUST_SITE_USES_ALL hcu,&#13;&#10;    pgsalpha.HZ_PARTY_SITES hps,&#13;&#10;    pgsalpha.hz_locations hzl,&#13;&#10;    pgsalpha.HZ_CUST_ACCOUNTS hca,&#13;&#10;    pgsalpha.HZ_PARTIES hzp&#13;&#10;  WHERE hcu.cust_acct_site_id = hcs.cust_acct_site_id&#13;&#10;  AND hcs.party_site_id       = hps.PARTY_SITE_ID&#13;&#10;  AND hps.location_id         = hzl.location_id&#13;&#10;  AND hcs.cust_account_id     = hca.cust_account_id&#13;&#10;  AND hca.party_id            = hzp.party_id&#13;&#10;  ) loc&#13;&#10;ON (PLH.SHIP_TO_ORG_ID=loc.SITE_USE_ID)&#13;&#10;LEFT OUTER JOIN&#13;&#10;  (SELECT conversion_rate ,&#13;&#10;    FROM_CURRENCY,&#13;&#10;    CONVERSION_DATE&#13;&#10;  FROM pgsalpha.gl_daily_rates&#13;&#10;  WHERE conversion_type='1000'&#13;&#10;  AND to_currency      ='USD'&#13;&#10;  ) conv_rt&#13;&#10;ON (PLH.TRANSACTIONAL_CURR_CODE = conv_rt.FROM_CURRENCY AND&#13;&#10;TO_DATE(conv_rt.CONVERSION_DATE,'yyyy-mm-dd')=PLH.CREATION_DATE)&#13;&#10;LEFT OUTER JOIN&#13;&#10;  (SELECT INVENTORY_ITEM_ID,&#13;&#10;    ORGANIZATION_ID,&#13;&#10;    ITEM_COST,&#13;&#10;    COST_TYPE_ID&#13;&#10;  FROM PGSALPHA.CST_ITEM_COSTS&#13;&#10;  WHERE COST_TYPE_ID=1&#13;&#10;  )cic&#13;&#10;ON (PLH.INVENTORY_ITEM_ID=cic.INVENTORY_ITEM_ID)&#13;&#10;AND (PLH.SHIP_FROM_ORG_ID=cic.ORGANIZATION_ID)&#13;&#10;LEFT OUTER JOIN&#13;&#10;  (SELECT CAST(attribute1 AS NUMERIC(19,4)) AS attribute1,&#13;&#10;    attribute2                              AS line_category&#13;&#10;  FROM pgsalpha.fnd_flex_values lc&#13;&#10;  WHERE lc.flex_value_set_id = 1007180&#13;&#10;  )line_cat&#13;&#10;ON (PLH.line_type_id            = line_cat.attribute1)&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="true"/>
    <elementParameter field="CHECK" name="PROPAGATE_RECORD_SET" value="false"/>
    <elementParameter field="COLUMN_LIST" name="RECORD_SET_COLUMN" show="false" value=""/>
    <elementParameter field="CHECK" name="USE_PREPAREDSTATEMENT" value="false"/>
    <elementParameter field="TABLE" name="SET_PREPAREDSTATEMENT_PARAMETERS" show="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" show="false" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="PARTS PSP STG"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tGreenplumRow_2"/>
    <metadata connector="REJECT" name="REJECT">
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tGreenplumRow" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="704" posY="64">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tGreenplumRow_3"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="true"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" value="tGreenplumConnection_1"/>
    <elementParameter field="TEXT" name="HOST" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PORT" show="false" value="&quot;5432&quot;"/>
    <elementParameter field="TEXT" name="DBNAME" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="PostgreSQL"/>
    <elementParameter field="TEXT" name="USER" show="false" value="&quot;&quot;"/>
    <elementParameter field="PASSWORD" name="PASS" show="false" value="0RMsyjmybrE="/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="USE_SSL" show="false" value="true"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;INSERT INTO SOT_PGSBACKLOG.BCKLG_CMN_ATTR&#13;&#10;SELECT ROW_NUMBER() OVER (PARTITION BY '1' ORDER BY '1') unique_id,&#13;&#10;  DECODE(ME,' Performance Services','Parts - PSP',SOURCE_DATA) data_source,&#13;&#10;  UPPER(COALESCE(COALESCE(B.PGS_REGION,C.PGS_REGION),X.PGS_REGION)) pgs_region,&#13;&#10;  UPPER(COALESCE(COALESCE(B.PGS_SUB_REGION,C.PGS_SUB_REGION),X.PGS_REGION)) pgs_sub_region,&#13;&#10;  UPPER(COALESCE(B.ISO_COUNTRY_NAME,COUNTRY_CODE)) country,&#13;&#10;  UPPER(STATE) ship_to_state,&#13;&#10;  'PSP' segment_tier_1,&#13;&#10;  'Parts - PSP' segment_tier_2,&#13;&#10;  LINE_TYPE segment_tier,&#13;&#10;  ORDER_NUMBER project_number,&#13;&#10;  SHIP_TO_CUST_NAME,&#13;&#10;  DESCRIPTION,&#13;&#10;  BOOK_DATE order_book_dtae,&#13;&#10;  LINE_NUM task_number,&#13;&#10;  TURBINE_NUM turbine_serial_number,&#13;&#10;  COALESCE(TURBINE_TECH,TURBINE_TECHNOLOGY) turbine_tech,&#13;&#10;  COALESCE(G.FRAME_SIZE,FRAME_TYPE) plf,&#13;&#10;  COALESCE(SUBSTR(ADN_NUMBER,1,3),ME) ME,&#13;&#10;  OA operations_contact,&#13;&#10;  CAST(A.LINE_ID AS VARCHAR)&#13;&#10;  ||'|'&#13;&#10;  ||ADN_NUMBER PM,&#13;&#10;  BILL_TO_CUST_NAME,&#13;&#10;  SUBSTR(customer_type,1,29) transaction_type,&#13;&#10;  CASE&#13;&#10;    WHEN TO_CHAR(PROMISE_DATE,'YYYYQ')&lt;TO_CHAR(CURRENT_DATE,'YYYYQ')&#13;&#10;    THEN CURRENT_DATE&#13;&#10;    ELSE PROMISE_DATE&#13;&#10;  END PROMISE_DATE ,&#13;&#10;  CUST_PO_NUMBER,&#13;&#10;  SUBSTR(ADN_NUMBER,1,3) qtr_convertible,&#13;&#10;  LINE_STATUS,&#13;&#10;  ORDER_AMOUNT ,&#13;&#10;  SALES_BOOKED ,&#13;&#10;  --DECODE(COALESCE(BILLABLE,'Y'),'Y',EXTENDED_PRICE,0) BACKLOG_old,   /* This logic has to be modified */&#13;&#10;  ROUND(EXTENDED_COST * (1/(1-(COALESCE(COALESCE(COALESCE(CAST(RGN.CM_PER AS NUMERIC),EPN.CM),50),50)/100))), 2) BACKLOG_AMT,&#13;&#10;  1 MOR,&#13;&#10;  DECODE (COALESCE(EXTENDED_PRICE,0),0,0,(EXTENDED_PRICE-EXTENDED_COST)*100/EXTENDED_PRICE) CM,&#13;&#10;  EXTENDED_COST,&#13;&#10;  'L' ind,&#13;&#10;  OI event_id,&#13;&#10;  BOOK_DATE event_start_date,&#13;&#10;  CD date_received,&#13;&#10;  ORDER_TYPE event_start_type,&#13;&#10;  FAMILY_CODE scope,&#13;&#10;  CASE&#13;&#10;    WHEN COALESCE(QUANTITY,0)=0&#13;&#10;    THEN 0&#13;&#10;    ELSE EXTENDED_COST/QUANTITY&#13;&#10;  END unit_cost,&#13;&#10;  CASE&#13;&#10;    WHEN COALESCE(QUANTITY,0)=0&#13;&#10;    THEN 0&#13;&#10;    ELSE EXTENDED_PRICE/QUANTITY&#13;&#10;  END unit_sales,&#13;&#10;  QUANTITY,&#13;&#10;  PART_NUMBER,&#13;&#10;  'PGS' vertical&#13;&#10;FROM SOT_PGSBACKLOG.PARTS_BACKLOG_STG_PSP A&#13;&#10;LEFT JOIN&#13;&#10;  (SELECT DISTINCT 1 IDN,SO_NR,LINE,LINE_ID, ADN FROM SOT_PGSBACKLOG.SCV_FILE_INPUT&#13;&#10;  ) SCV&#13;&#10;ON A.ORDER_NUMBER=SCV.SO_NR&#13;&#10;AND A.LINE_ID    =SCV.LINE_ID&#13;&#10;LEFT JOIN SOT_PGSBACKLOG.BACKLOG_TERRITORY_CODE D&#13;&#10;ON A.COUNTRY_CODE = D.TERRITORY_CODE&#13;&#10;LEFT JOIN SOT_PGSBACKLOG.PARTS_LITTLE_BCKLG PP&#13;&#10;ON PP.ORD=A.ORDER_NUMBER&#13;&#10;LEFT JOIN SOT_PGSBACKLOG.BACKLOG_PGS_REGION_FROM_CODE B&#13;&#10;ON&#13;&#10;  CASE&#13;&#10;    WHEN UPPER(D.ISO_TERRITORY_CODE) = 'USA'&#13;&#10;    THEN UPPER(A.STATE)&#13;&#10;    ELSE UPPER(D.ISO_TERRITORY_CODE)&#13;&#10;  END = B.STATE_COUNTRY_CODE&#13;&#10;LEFT JOIN SOT_PGSBACKLOG.BACKLOG_PGS_REGION_FROM_NAME C&#13;&#10;ON&#13;&#10;  CASE&#13;&#10;    WHEN UPPER(A.COUNTRY_CODE) = 'UNITED STATES'&#13;&#10;    THEN UPPER(A.STATE)&#13;&#10;    ELSE UPPER(A.COUNTRY_CODE)&#13;&#10;  END = UPPER(C.STATE_COUNTRY_NAME)&#13;&#10;LEFT JOIN SOT_PGSBACKLOG.BACKLOG_PGS_REGION_FROM_NAME X&#13;&#10;ON&#13;&#10;  CASE&#13;&#10;    WHEN UPPER(D.ISO_TERRITORY_CODE) = 'USA'&#13;&#10;    THEN UPPER(A.STATE)&#13;&#10;    ELSE UPPER(D.ISO_TERRITORY_CODE)&#13;&#10;  END = X.STATE_COUNTRY_NAME&#13;&#10;LEFT JOIN SOT_PGSBACKLOG.BACKLOG_GIB_SRC G&#13;&#10;ON A.TURBINE_NUM = G.TSN&#13;&#10;LEFT JOIN SOT_PGSBACKLOG.EPN_CM_PER RGN&#13;&#10;  ON SUBSTR(A.adn_number,(LENGTH(A.adn_number) - 7),8)=RGN.FSR&#13;&#10;  LEFT JOIN&#13;&#10;    (SELECT MAX(project_name) project_name,&#13;&#10;      order_number EFSR,&#13;&#10;      MAX(order_amount) CM&#13;&#10;    FROM SOT_PGSBACKLOG.cm_per_dr4_sc&#13;&#10;    WHERE tier_1_segment='Parts'&#13;&#10;    GROUP BY order_number&#13;&#10;    ) EPN&#13;&#10;  ON SUBSTR(A.adn_number,(LENGTH(A.adn_number) - 7),8)=EFSR&#13;&#10;WHERE ME         ='Performance Services'&#13;&#10;and coalesce(IDN,2)&lt;&gt;1&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="true"/>
    <elementParameter field="CHECK" name="PROPAGATE_RECORD_SET" value="false"/>
    <elementParameter field="COLUMN_LIST" name="RECORD_SET_COLUMN" show="false" value=""/>
    <elementParameter field="CHECK" name="USE_PREPAREDSTATEMENT" value="false"/>
    <elementParameter field="TABLE" name="SET_PREPAREDSTATEMENT_PARAMETERS" show="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" show="false" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="PARTS PSP CMN ATTR"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tGreenplumRow_3"/>
    <metadata connector="REJECT" name="REJECT">
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tGreenplumClose" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="928" posY="64">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tGreenplumClose_1"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" value="tGreenplumConnection_1"/>
    <elementParameter field="TEXT" name="LABEL" value="Close"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
  </node>
  <node componentName="tGreenplumRow" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="192" posY="64">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tGreenplumRow_4"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="true"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" value="tGreenplumConnection_1"/>
    <elementParameter field="TEXT" name="HOST" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PORT" show="false" value="&quot;5432&quot;"/>
    <elementParameter field="TEXT" name="DBNAME" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="PostgreSQL"/>
    <elementParameter field="TEXT" name="USER" show="false" value="&quot;&quot;"/>
    <elementParameter field="PASSWORD" name="PASS" show="false" value="0RMsyjmybrE="/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="USE_SSL" show="false" value="true"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;&#13;&#10;TRUNCATE TABLE SOT_PGSBACKLOG.PARTS_LINE_HEADERS_PSP;&#13;&#10;&#13;&#10;TRUNCATE TABLE SOT_PGSBACKLOG.PARTS_BACKLOG_STG_PSP;&#13;&#10;&#13;&#10;&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="true"/>
    <elementParameter field="CHECK" name="PROPAGATE_RECORD_SET" value="false"/>
    <elementParameter field="COLUMN_LIST" name="RECORD_SET_COLUMN" show="false" value=""/>
    <elementParameter field="CHECK" name="USE_PREPAREDSTATEMENT" value="false"/>
    <elementParameter field="TABLE" name="SET_PREPAREDSTATEMENT_PARAMETERS" show="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" show="false" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="TRUNCATE TABLE"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tGreenplumRow_4"/>
    <metadata connector="REJECT" name="REJECT">
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tGreenplumConnection" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="64" posY="64">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tGreenplumConnection_1"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_Hh2X4Ph4EeiAgrX6wwvW1w"/>
    <elementParameter field="TEXT" name="HOST" value="context.RFM_GPDB_SOT_BACKLOG_AWS_Server"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="GREENPLUM"/>
    <elementParameter field="TEXT" name="PORT" value="context.RFM_GPDB_SOT_BACKLOG_AWS_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.RFM_GPDB_SOT_BACKLOG_AWS_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.RFM_GPDB_SOT_BACKLOG_AWS_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.RFM_GPDB_SOT_BACKLOG_AWS_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="8pW6Nmy2kuetVPV/HFSFZ2C1BvSndzTrGdTks8c0L8743cGxd394MPzVRbZ1Z5LM"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="USE_SHARED_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="SHARED_CONNECTION_NAME" show="false" value=""/>
    <elementParameter field="CHECK" name="USE_SSL" value="true"/>
    <elementParameter field="CHECK" name="AUTO_COMMIT" value="true"/>
    <elementParameter field="TEXT" name="LABEL" value="GP PROD"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
  </node>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tGreenplumRow_1" offsetLabelX="0" offsetLabelY="0" source="tGreenplumRow_1" target="tGreenplumRow_2">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk1"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tGreenplumRow_2" offsetLabelX="0" offsetLabelY="0" source="tGreenplumRow_2" target="tGreenplumRow_3">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk2"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tGreenplumRow_3" offsetLabelX="0" offsetLabelY="0" source="tGreenplumRow_3" target="tGreenplumClose_1">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk4"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tGreenplumRow_4" offsetLabelX="0" offsetLabelY="0" source="tGreenplumRow_4" target="tGreenplumRow_1">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk6"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tGreenplumConnection_1" offsetLabelX="0" offsetLabelY="0" source="tGreenplumConnection_1" target="tGreenplumRow_4">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk3"/>
  </connection>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tGreenplumRow_1"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tGreenplumRow_2"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tGreenplumRow_3"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tGreenplumClose_1"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tGreenplumRow_4"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tGreenplumConnection_1"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
<Signature xmlns="http://www.w3.org/2000/09/xmldsig#" Id="_a3490b65-6903-48e7-b545-6045af8d35ea"><SignedInfo><CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/><SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha512"/><Reference URI=""><Transforms><Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/></Transforms><DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha512"/><DigestValue>PrdItne6Iiifns6nZd1zXQk7ZM/gJG9d7PXu6icJC3zD8cGn91e0/cxyPg/i2oEqlkgqOlrU+ntG
3PPfkrwdGA==</DigestValue></Reference><Reference Type="http://www.w3.org/2000/09/xmldsig#SignatureProperties" URI="#_be6d0173-e9d8-4c55-b113-b8be4eabf0a0"><Transforms><Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/></Transforms><DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha512"/><DigestValue>FY3kyfmCO7mysXOybebddvcj1uxY5QXVnwkxEXkET/4EnuCDKO6eQmRWz+2ql3xmJd/oSUPDc+0x
CMxMzAJQow==</DigestValue></Reference></SignedInfo><SignatureValue>XL42AJr4qhSn6BbK5EMusCdxmrb6DZ7JWQ76kypeII1IzjuosXz1avPp7FLjiPR6boE/haB88++D
LNgekZS+xQ7CAknvc7tLBQjfrTUO2jfottGRjOkqE3llmhk1OmJ0Twy7cDWAa8aSnxkNPmAZhCdZ
Xt/nStyxKFLTHewhqHHR3S9lBGrJUGOHjK3dI1UhDZFxcJz9a5mEZacSvF6cTxouWu1+lLEaFCoc
3+b9VL8WUqvM6pesSUFF+UknfX1Dgymc0TG8hfCAIS2gwQajek/4yX4jkLfg1+fDLmFVVlSpV+Kj
XwAwJrx3Z36jFWjDA19RNva69zfh20GLFo6AyA==</SignatureValue><KeyInfo><X509Data><X509SubjectName>C=FR,ST=Paris,L=Paris,O=Talend Inc.,OU=R&amp;D,CN=Talend Code Signing certificate</X509SubjectName><X509Certificate>MIIFADCCAuigAwIBAgIIA2OsD6bRyj0wDQYJKoZIhvcNAQELBQAwgY0xCzAJBgNVBAYTAkZSMQ4w
DAYDVQQIEwVQYXJpczEOMAwGA1UEBxMFUGFyaXMxFDASBgNVBAoTC1RhbGVuZCBJbmMuMQwwCgYD
VQQLDANSJkQxFjAUBgNVBAMMDVRhbGVuZCBSJkQgQ0ExIjAgBgkqhkiG9w0BCQEWE3NlY3VyaXR5
QHRhbGVuZC5jb20wHhcNMTkwNjAzMDgxODIwWhcNMjkwNjAzMDAwMDAwWjB7MSgwJgYDVQQDEx9U
YWxlbmQgQ29kZSBTaWduaW5nIGNlcnRpZmljYXRlMQwwCgYDVQQLDANSJkQxFDASBgNVBAoTC1Rh
bGVuZCBJbmMuMQ4wDAYDVQQHEwVQYXJpczEOMAwGA1UECBMFUGFyaXMxCzAJBgNVBAYTAkZSMIIB
IjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAp5TMF8BmRt8dY51t9kIDdDkoOKVVytJN2gn2
DhMGi8hzpUofNDykJDhe9SPqyJdGZ6o/h7laTA0/CivKyPT1OJQ9E2gMHKs8cTZM/cO2w0Atlqkl
alIxepol0DNnUtmECVBqdnVsJesfmdoeptxgJAtxYbquFsTsrATNY2cscXpwmOca/Ewip48WQLFx
e5s067jaIsAQGRIqpIup3bOtWBySrtImJ40lQCPeEcl96qzkv3utaVaNc3ukkhYkCDbMbK8NVd1B
CVeeIBAe+n/SdpHH20o+6eIiZecsBGDLwlTYrFvuVqAa6xI7y8Vdz6irjPAVBEtG/iOc782aJ/lZ
TwIDAQABo3UwczAMBgNVHRMBAf8EAjAAMA4GA1UdDwEB/wQEAwIHgDATBgNVHSUEDDAKBggrBgEF
BQcDAzAdBgNVHQ4EFgQUGdfzQEbjQnANq28sfhEMTx+rsOcwHwYDVR0jBBgwFoAU530Lcvy1gZnG
gCvZLOyCczK1qPcwDQYJKoZIhvcNAQELBQADggIBAEr22wnaQwZm2dhbUCqD+qZpTq2AF/tzxqAM
eL/CiTjPbTblS4SNNwCKvTgMe9ucpUbenXmK7xE+DU9dN4om+t3VHbkOLQVyuLcd2WGsy7ZGwRvA
f+TFwLbwjyTukOGm6Sd1qyZgvCPzBsKnft6vscvGy2yEpmFCeHJyBP8pvchg607zguRdNbkGYZXw
G6jNipAbTtzdPTFKKr1bEf0sUGqMrlZIMPjflh2Vewu8ImNdX5IZdvBD6DdFVOC5wqV6u+W9ukE/
mXZxDBYNl2AF7FTh04ucEVN3mHv7m2L0uFvUlhxchcagJhJsdQG+A0LVCemHbp6CSNQJx02KxqUG
hakvpzhOyLo91h8YAQrEZJdNuKA8IYmBrFZQZDCz0uywKSyFfzPyJhvxylCLG/iDPPfE0VWcrMJ/
WQJly/2XPg/NBCTF3pSKS0kCiA7PeaI3cWkMYYA3PMwYDvzqs1opBRglG7ikj0bQxSm3lcjMuuvW
gBRksFKjP3K/nztsjSoYITOM9jR29ReIL3v0E8RbAFwA2RGq6Dxd0ixfbucMesy5Gnr8tfYy6rW+
qSQqd3ah4+PSzBNVwIB4ytpdrG3SlhCI2i2Th8ek8Sjsaquh9qPAerWNd2+84HWOOGj1Xe1qc6vg
qqu6JoK9EXKDiwBqDVkueIa+MhamE1VDnhn2pPui</X509Certificate></X509Data></KeyInfo><Object><SignatureProperties><SignatureProperty Id="_be6d0173-e9d8-4c55-b113-b8be4eabf0a0" Target="#_a3490b65-6903-48e7-b545-6045af8d35ea"><Timestamp>2020-05-12 17:49:20</Timestamp></SignatureProperty></SignatureProperties></Object></Signature></talendfile:ProcessType>